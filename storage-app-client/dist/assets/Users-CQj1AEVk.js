import{u as m,j as e,a as y,i as h}from"./index-CDqGnBVK.js";import{r as o}from"./vendor-8AKiDlQN.js";import{L as u}from"./router-BmsaeIqg.js";import{P as j}from"./Pagination-5t7NGcsB.js";import{t as b,d as v,a as N}from"./usersService--1COgLA-.js";import"./api-BqC8VQ1e.js";const w=({onFilterChange:d})=>{const{t:i}=m(),[l,t]=o.useState(""),[r,n]=o.useState(""),[x,g]=o.useState(""),s=a=>{a.preventDefault(),d({name:l,email:r,role:x})};return e.jsx("form",{onSubmit:s,className:"mb-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",placeholder:i("filter_by_name"),value:l,onChange:a=>t(a.target.value),className:"border rounded px-2 py-1"}),e.jsx("input",{type:"text",placeholder:i("filter_by_email"),value:r,onChange:a=>n(a.target.value),className:"border rounded px-2 py-1"}),e.jsxs("select",{value:x,onChange:a=>g(a.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:i("all_roles")}),e.jsx("option",{value:"admin",children:i("admin")}),e.jsx("option",{value:"user",children:i("user")})]}),e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-1 rounded hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:i("apply_filters")})]})})},_=({users:d,onUserDeleted:i,onUserUpdated:l})=>{const{t}=m(),{user:r}=y(),{showFlashMessage:n}=h(),x=async s=>{if(window.confirm(t("confirm_delete_user")))try{await v(s),i==null||i(s),n(t("user_deleted_successfully"),"success")}catch(a){console.error("Error deleting user:",a),n(t("error_deleting_user"),"error")}},g=async s=>{try{const a=await b(s);n(a.msg,"success"),l==null||l()}catch(a){console.error("Error toggling user status:",a),n(t("error_toggling_user_status"),"error")}};return e.jsx("div",{className:"overflow-x-auto relative",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("email")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("role")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky right-0 bg-gray-50 shadow-l",children:t("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map((s,a)=>e.jsxs("tr",{className:`${a%2===0?"bg-white":"bg-gray-50"} ${s.is_active===!1?"opacity-60":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(r==null?void 0:r.role)==="admin"?e.jsx(u,{to:`/users/${s._id}`,className:`${s.is_active===!1?"text-gray-500":"text-indigo-600 hover:text-indigo-900"}`,children:s.name}):e.jsx("span",{className:s.is_active===!1?"text-gray-500":"",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:s.is_active===!1?"text-gray-500":"",children:s.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"} ${s.is_active===!1?"opacity-50":""}`,children:s.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?t("active"):t("inactive")})}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap sticky right-0 shadow-l ${a%2===0?"bg-white":"bg-gray-50"}`,children:(r==null?void 0:r.role)==="admin"&&s._id!==r._id&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>g(s._id),className:`px-3 py-1 text-xs rounded ${s.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.is_active?t("deactivate"):t("activate")}),e.jsx("button",{onClick:()=>x(s._id),className:"text-red-600 hover:text-red-900 text-xs",children:t("delete")})]})})]},s._id))})]})})},F=()=>{const{t:d}=m(),{showFlashMessage:i}=h(),[l,t]=o.useState([]),[r,n]=o.useState(1),[x,g]=o.useState(1),[s,a]=o.useState({name:"",email:"",role:""});o.useEffect(()=>{p()},[]);const p=async()=>{try{const c=await N(r,s);t(c.users),g(c.totalPages)}catch(c){i(typeof c=="string"?c:c.message,"error")}},f=c=>{a(c),n(1)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:d("users")}),e.jsx(u,{to:"/create-user",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:d("create_user")})]}),e.jsx(w,{onFilterChange:f}),e.jsx(_,{users:l,onUserDeleted:()=>p(),onUserUpdated:()=>p()}),e.jsx(j,{currentPage:r,totalPages:x,onPageChange:n})]})};export{F as default};
