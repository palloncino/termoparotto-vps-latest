import{u as w,r,j as e,a as h,L as n}from"./index-DJyII19s.js";import{a as N,d as _}from"./worksiteService-DYYBNIXI.js";import{c as b}from"./clientService-yk40VqrK.js";import"./api-CDIV21FI.js";const W=()=>{const{t:s}=w(),[c,l]=r.useState([]),[o,u]=r.useState({}),[f,d]=r.useState(!0),[x,m]=r.useState(null);r.useEffect(()=>{g()},[]);const g=async()=>{d(!0);try{const t=await N();l(t),m(null);const j=(await Promise.all(t.map(a=>b(a.client_id)))).reduce((a,p)=>(a[p._id]=p,a),{});u(j)}catch(t){m(s("error_fetching_worksites")),console.error("Error fetching worksites:",t)}finally{d(!1)}},y=async t=>{if(window.confirm(s("confirm_delete_worksite")))try{await _(t),l(c.filter(i=>i._id!==t))}catch(i){console.error("Error deleting worksite:",i)}};return f?e.jsx(h,{}):x?e.jsxs("div",{children:[s("error_message"),": ",x]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:s("worksites")}),e.jsx(n,{to:"/worksites/create",className:"mb-4 inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:s("create_worksite")}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("client")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("active")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o[t.client_id]?e.jsx(n,{to:`/clients/${t.client_id}`,className:"text-blue-500 hover:text-blue-700",children:o[t.client_id].name}):e.jsx(h,{})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.is_active?s("yes"):s("no")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx(n,{to:`/worksites/${t._id}`,className:"text-indigo-600 hover:text-indigo-900",children:s("edit")}),e.jsx("button",{onClick:()=>y(t._id),className:"ml-4 text-red-600 hover:text-red-900",children:s("delete")})]})]},t._id))})]})]})};export{W as default};
