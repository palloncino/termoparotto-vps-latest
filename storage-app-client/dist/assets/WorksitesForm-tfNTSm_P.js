import{u as b,d as y,c as w,r as o,j as e,a as k}from"./index-DFnUBA3S.js";import{b as N,u as C,c as S}from"./worksiteService-CfPHAhQs.js";import{a as W}from"./clientService-Bj64bQzW.js";import"./api-CLE4YwRs.js";const B=()=>{const{t:s}=b(),{id:i}=y(),h=w(),[t,l]=o.useState(null),[f,g]=o.useState([]),[p,n]=o.useState(!0),[m,c]=o.useState(null);o.useEffect(()=>{i?v(i):(l({_id:"",client_id:"",name:"",address:"",description:"",is_active:!0}),n(!1)),_()},[i]);const v=async r=>{n(!0);try{const a=await N(r);l(a),c(null)}catch(a){c(s("error_fetching_worksite")),console.error("Error fetching worksite:",a)}finally{n(!1)}},_=async()=>{try{const r=await W();g(r.clients)}catch(r){console.error(s("error_fetching_clients"),r)}},j=async r=>{if(r.preventDefault(),!!t){n(!0);try{i?await C(i,t):await S(t),h("/worksites")}catch(a){c(s("error_saving_worksite")),console.error(s("error_saving_worksite"),a)}finally{n(!1)}}},d=r=>{const{name:a,value:u}=r.target;l(x=>x?{...x,[a]:a==="is_active"?u==="true":u}:null)};return p?e.jsx(k,{}):m?e.jsxs("div",{children:[s("error_message"),": ",m]}):t?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:s(i?"edit_worksite":"create_worksite")}),e.jsx("form",{onSubmit:j,children:e.jsxs("div",{className:"shadow overflow-hidden sm:rounded-md",children:[e.jsx("div",{className:"px-4 py-5 bg-white sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-6 gap-6",children:[e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:s("name")}),e.jsx("input",{type:"text",name:"name",id:"name",value:(t==null?void 0:t.name)||"",onChange:d,className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700",children:s("client")}),e.jsxs("select",{name:"client_id",id:"client_id",value:(t==null?void 0:t.client_id)||"",onChange:d,className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:s("select_client")}),f.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]})]}),e.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[e.jsx("label",{htmlFor:"is_active",className:"block text-sm font-medium text-gray-700",children:s("active")}),e.jsxs("select",{name:"is_active",id:"is_active",value:t!=null&&t.is_active?"true":"false",onChange:d,className:"mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",children:[e.jsx("option",{value:"true",children:s("yes")}),e.jsx("option",{value:"false",children:s("no")})]})]})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s(i?"update_worksite":"create_worksite")})})]})})]}):e.jsx("div",{children:s("worksite_not_found")})};export{B as default};
