import{u as v,j as e}from"./index-Cs62EXw_.js";import{r as c}from"./vendor-8AKiDlQN.js";import{a as k}from"./clientService-qRF0PNhS.js";import{d as T}from"./reportService-CmqWvr86.js";import{a as D}from"./usersService--1COgLA-.js";import{a as C}from"./worksiteService-DblhuvHv.js";import{T as x}from"./Tooltip-BYitMSub.js";import{f as d}from"./formatDate-BuXJr5y_.js";import{u as E}from"./router-BmsaeIqg.js";const P=({reports:o,onReportDeleted:f})=>{const{t}=v(),m=E(),[S,g]=c.useState([]),[R,y]=c.useState([]),[W,j]=c.useState([]);c.useEffect(()=>{(async()=>{try{const[i,l,r]=await Promise.all([D(),k(),C()]);g(i.users),y(l.clients),j(r)}catch(i){console.error("Error fetching filter data:",i)}})()},[]);const w=async s=>{if(window.confirm(t("confirm_delete")))try{await T(s),f()}catch(i){console.error("Error deleting report:",i)}};return e.jsx("div",{children:o.length===0?e.jsx("p",{children:t("no_reports_found")}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("created")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("last_updated")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("technician")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("activities")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("total_hours")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(s=>{var p,u;const i=typeof s.technician_id=="object"&&s.technician_id!==null?s.technician_id.name:t("not_assigned"),l=((p=s.activities)==null?void 0:p.reduce((a,n)=>{var h;const N=((h=n.tasks)==null?void 0:h.reduce((b,_)=>b+(_.work_hours||0),0))||0;return a+N},0))||0,r=((u=s.activities)==null?void 0:u.length)||0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.date?(()=>{const{text:a,isToday:n}=d(s.date,t);return n?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:a}):a})():""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.created?(()=>{const{text:a,isToday:n}=d(s.created,t);return n?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:a}):a})():t("not_specified")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.last_updated?(()=>{const{text:a,isToday:n}=d(s.last_updated,t);return n?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:a}):a})():t("not_specified")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[r," ",t(r===1?"activity":"activities")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("span",{className:"font-medium",children:[l.toFixed(1)," ",t("hours")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="in_progress"?"bg-yellow-100 text-yellow-800":s.status==="planned"?"bg-blue-100 text-blue-800":s.status==="SIMULATION_TEST"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:t(s.status)||t("not_specified")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(x,{content:t("view_report"),children:e.jsx("button",{onClick:()=>m(`/reports/${s._id}`),className:"text-blue-500 hover:text-blue-700 font-medium",children:t("view")})}),e.jsx(x,{content:t("edit_report"),children:e.jsx("button",{onClick:()=>m(`/reports/${s._id}/edit`),className:"text-green-500 hover:text-green-700 font-medium",children:t("edit")})}),e.jsx(x,{content:t("delete_report"),children:e.jsx("button",{onClick:()=>w(s._id),className:"text-red-500 hover:text-red-700 font-medium",children:t("delete")})})]})})]},s._id)})})]})})})};export{P as R};
