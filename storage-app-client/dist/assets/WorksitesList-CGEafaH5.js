import{u as y,j as e,L as g}from"./index-DSTbHML1.js";import{r as a}from"./vendor-8AKiDlQN.js";import{a as v,d as k}from"./worksiteService-DblhuvHv.js";import{e as S}from"./clientService-qRF0PNhS.js";import{L as u}from"./router-BmsaeIqg.js";import{f as C}from"./formatDate-BAMmqpAD.js";import"./api-BqC8VQ1e.js";const L=({onFilterChange:s})=>{const{t:i}=y(),[c,d]=a.useState(""),[o,h]=a.useState(""),[l,x]=a.useState(""),p=r=>{r.preventDefault(),s({name:c,clientName:o,address:l})};return e.jsx("form",{onSubmit:p,className:"mb-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",placeholder:i("filter_by_name"),value:c,onChange:r=>d(r.target.value),className:"border rounded px-2 py-1"}),e.jsx("input",{type:"text",placeholder:i("filter_by_client"),value:o,onChange:r=>h(r.target.value),className:"border rounded px-2 py-1"}),e.jsx("input",{type:"text",placeholder:i("filter_by_address"),value:l,onChange:r=>x(r.target.value),className:"border rounded px-2 py-1"}),e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-1 rounded hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:i("apply_filters")})]})})},B=()=>{const{t:s}=y(),[i,c]=a.useState([]),[d,o]=a.useState({}),[h,l]=a.useState(!0),[x,p]=a.useState(null),[r,j]=a.useState({name:"",clientName:"",address:""});a.useEffect(()=>{N()},[]);const N=async()=>{l(!0);try{const t=await v();c(t),p(null);const b=(await Promise.all(t.map(m=>S(m.client_id)))).reduce((m,f)=>(m[f._id]=f,m),{});o(b)}catch(t){p(s("error_fetching_worksites")),console.error("Error fetching worksites:",t)}finally{l(!1)}},w=async t=>{if(window.confirm(s("confirm_delete_worksite")))try{await k(t),c(i.filter(n=>n._id!==t))}catch(n){console.error("Error deleting worksite:",n)}},_=t=>{j(t)};return h?e.jsx(g,{}):x?e.jsxs("div",{children:[s("error_message"),": ",x]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("worksites")}),e.jsx(u,{to:"/worksites/create",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s("create_worksite")})]}),e.jsx(L,{onFilterChange:_}),e.jsx("div",{className:"overflow-x-auto relative",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("client")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("address")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("active")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("end_date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("planned_hours")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky right-0 bg-gray-50 shadow-l",children:s("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map((t,n)=>e.jsxs("tr",{className:n%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d[t.client_id]?e.jsx(u,{to:`/clients/${t.client_id}`,className:"text-blue-500 hover:text-blue-700",children:d[t.client_id].name}):e.jsx(g,{})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.address}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.is_active?s("yes"):s("no")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.end_date?C(t.end_date,s):s("not_specified")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.planned_hours||s("not_specified")}),e.jsxs("td",{className:`px-6 py-4 whitespace-nowrap sticky right-0 shadow-l ${n%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx(u,{to:`/worksites/${t._id}`,className:"text-indigo-600 hover:text-indigo-900",children:s("edit")}),e.jsx("button",{onClick:()=>t._id&&w(t._id),className:"ml-4 text-red-600 hover:text-red-900",children:s("delete")})]})]},t._id))})]})})]})};export{B as default};
