import{u as j,d as w,c as _,r as i,j as e,a as N}from"./index-DrlQhJEk.js";import{b as k,u as C,c as F}from"./worksiteService-CfPHAhQs.js";import{a as S}from"./clientService-D0rezJXS.js";import"./api-CLE4YwRs.js";const I=()=>{const{t}=j(),{id:r}=w(),p=_(),[s,c]=i.useState(null),[f,b]=i.useState([]),[u,o]=i.useState(!0),[m,d]=i.useState(null);i.useEffect(()=>{r?g(r):(c({client_id:"",name:"",address:"",description:"",is_active:!0}),o(!1)),y()},[r]);const g=async a=>{o(!0);try{const n=await k(a);c(n),d(null)}catch(n){d(t("error_fetching_worksite")),console.error("Error fetching worksite:",n)}finally{o(!1)}},y=async()=>{try{const a=await S();b(a.clients)}catch(a){console.error(t("error_fetching_clients"),a)}},v=async a=>{if(a.preventDefault(),!!s){o(!0);try{r?await C(r,s):await F(s),p("/worksites")}catch(n){d(t("error_saving_worksite")),console.error(t("error_saving_worksite"),n)}finally{o(!1)}}},l=a=>{const{name:n,value:x}=a.target;c(h=>h?{...h,[n]:n==="is_active"?x==="true":x}:null)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:t(r?"edit_worksite":"create_worksite")}),e.jsx("form",{onSubmit:v,className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg px-8 pt-6 pb-8 mb-6",children:[m&&e.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:m}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"name",className:"block text-gray-700 text-sm font-bold mb-2",children:[t("name")," *"]}),e.jsx("input",{type:"text",id:"name",name:"name",value:(s==null?void 0:s.name)||"",onChange:l,required:!0,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"address",className:"block text-gray-700 text-sm font-bold mb-2",children:[t("address")," *"]}),e.jsx("input",{type:"text",id:"address",name:"address",value:(s==null?void 0:s.address)||"",onChange:l,required:!0,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"client_id",className:"block text-gray-700 text-sm font-bold mb-2",children:[t("client")," *"]}),e.jsxs("select",{id:"client_id",name:"client_id",value:(s==null?void 0:s.client_id)||"",onChange:l,required:!0,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"",children:t("select_client")}),f.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"is_active",className:"block text-gray-700 text-sm font-bold mb-2",children:t("active")}),e.jsxs("select",{id:"is_active",name:"is_active",value:s!=null&&s.is_active?"true":"false",onChange:l,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"true",children:t("yes")}),e.jsx("option",{value:"false",children:t("no")})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:t("description")}),e.jsx("textarea",{id:"description",name:"description",value:(s==null?void 0:s.description)||"",onChange:l,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:3})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:u?e.jsx(N,{}):t(r?"update_worksite":"create_worksite")})})]})})]})};export{I as default};
