import{u as w,r as a,j as e,b as h,L as n}from"./index-Bju_Xr-6.js";import{a as N,d as _}from"./worksiteService-Bsvx2crQ.js";import{e as b}from"./clientService-DWml5I6n.js";import{f as v}from"./formatDate-CFXLpRQ8.js";import"./api-B396KAwJ.js";const S=()=>{const{t:s}=w(),[c,l]=a.useState([]),[d,u]=a.useState({}),[f,x]=a.useState(!0),[o,p]=a.useState(null);a.useEffect(()=>{y()},[]);const y=async()=>{x(!0);try{const t=await N();l(t),p(null);const j=(await Promise.all(t.map(i=>b(i.client_id)))).reduce((i,m)=>(i[m._id]=m,i),{});u(j)}catch(t){p(s("error_fetching_worksites")),console.error("Error fetching worksites:",t)}finally{x(!1)}},g=async t=>{if(window.confirm(s("confirm_delete_worksite")))try{await _(t),l(c.filter(r=>r._id!==t))}catch(r){console.error("Error deleting worksite:",r)}};return f?e.jsx(h,{}):o?e.jsxs("div",{children:[s("error_message"),": ",o]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:s("worksites")}),e.jsx(n,{to:"/worksites/create",className:"mb-4 inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:s("create_worksite")}),e.jsx("div",{className:"overflow-x-auto relative",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("client")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("address")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("active")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("end_date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("planned_hours")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d[t.client_id]?e.jsx(n,{to:`/clients/${t.client_id}`,className:"text-blue-500 hover:text-blue-700",children:d[t.client_id].name}):e.jsx(h,{})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.address}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.is_active?s("yes"):s("no")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.end_date?v(t.end_date,s):s("not_specified")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.planned_hours||s("not_specified")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx(n,{to:`/worksites/${t._id}`,className:"text-indigo-600 hover:text-indigo-900",children:s("edit")}),e.jsx("button",{onClick:()=>t._id&&g(t._id),className:"ml-4 text-red-600 hover:text-red-900",children:s("delete")})]})]},t._id))})]})})]})};export{S as default};
