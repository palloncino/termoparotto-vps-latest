import{u as h,r as o,j as e,g as y,k as g,L as f}from"./index-BzT01pgb.js";import{P as j}from"./Pagination-DMuZ8mp5.js";import{d as v,t as b,a as N}from"./usersService-uZA3Dl4C.js";import"./api-DvPabNxM.js";const _=({onFilterChange:d})=>{const{t:i}=h(),[n,t]=o.useState(""),[r,l]=o.useState(""),[x,p]=o.useState(""),s=a=>{a.preventDefault(),d({name:n,email:r,role:x})};return e.jsx("form",{onSubmit:s,className:"mb-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",placeholder:i("filter_by_name"),value:n,onChange:a=>t(a.target.value),className:"border rounded px-2 py-1"}),e.jsx("input",{type:"text",placeholder:i("filter_by_email"),value:r,onChange:a=>l(a.target.value),className:"border rounded px-2 py-1"}),e.jsxs("select",{value:x,onChange:a=>p(a.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:i("all_roles")}),e.jsx("option",{value:"admin",children:i("admin")}),e.jsx("option",{value:"user",children:i("user")})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-1 rounded",children:i("apply_filters")})]})})},w=({users:d,onUserDeleted:i,onUserUpdated:n})=>{const{t}=h(),{user:r}=y(),{showFlashMessage:l}=g(),x=async s=>{if(window.confirm(t("confirm_delete_user")))try{await v(s),i==null||i(s),l(t("user_deleted_successfully"),"success")}catch(a){console.error("Error deleting user:",a),l(t("error_deleting_user"),"error")}},p=async s=>{try{const a=await b(s);l(a.msg,"success"),n==null||n()}catch(a){console.error("Error toggling user status:",a),l(t("error_toggling_user_status"),"error")}};return e.jsx("div",{className:"overflow-x-auto relative",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("email")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("role")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky right-0 bg-gray-50 shadow-l",children:t("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(s=>e.jsxs("tr",{className:s.is_active===!1?"bg-gray-50":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(r==null?void 0:r.role)==="admin"?e.jsx(f,{to:`/users/${s._id}`,className:`${s.is_active===!1?"text-gray-500":"text-indigo-600 hover:text-indigo-900"}`,children:s.name}):e.jsx("span",{className:s.is_active===!1?"text-gray-500":"",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:s.is_active===!1?"text-gray-500":"",children:s.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"} ${s.is_active===!1?"opacity-50":""}`,children:s.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?t("active"):t("inactive")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap sticky right-0 bg-white shadow-l",children:(r==null?void 0:r.role)==="admin"&&s._id!==r._id&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>p(s._id),className:`px-3 py-1 text-xs rounded ${s.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.is_active?t("deactivate"):t("activate")}),e.jsx("button",{onClick:()=>x(s._id),className:"text-red-600 hover:text-red-900 text-xs",children:t("delete")})]})})]},s._id))})]})})},E=()=>{const{t:d}=h(),{showFlashMessage:i}=g(),[n,t]=o.useState([]),[r,l]=o.useState(1),[x,p]=o.useState(1),[s,a]=o.useState({name:"",email:"",role:""});o.useEffect(()=>{m()},[]);const m=async()=>{try{const c=await N(r,s);t(c.users),p(c.totalPages)}catch(c){i(typeof c=="string"?c:c.message,"error")}},u=c=>{a(c),l(1)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:d("users")}),e.jsx(_,{onFilterChange:u}),e.jsx(w,{users:n,onUserDeleted:()=>m(),onUserUpdated:()=>m()}),e.jsx(j,{currentPage:r,totalPages:x,onPageChange:l})]})};export{E as default};
