import{u as f,i as j,h as v,g as w,r as l,j as e}from"./index-BzT01pgb.js";import{e as _,u as N}from"./productsService-Bq_90fQ-.js";import"./api-DvPabNxM.js";const P=()=>{const{t:n}=f(),{id:i}=j(),h=v(),{user:s}=w(),[r,u]=l.useState(null),[c,d]=l.useState(!1);l.useEffect(()=>{g()},[i]);const g=async()=>{try{const t=await _(i);u(t)}catch(t){console.error(n("error_fetching_product"),t)}},x=async t=>{if(t.preventDefault(),(s==null?void 0:s.role)!=="admin"){alert(n("admin_update_alert"));return}try{await N(i,r),d(!1),alert(n("product_update_success"))}catch(o){console.error(n("error_updating_product"),o),alert(n("product_update_failed"))}},m=t=>{const{name:o,value:p}=t.target;u(b=>({...b,[o]:o.includes("prezzo")||o.includes("utile")||o.includes("imponibile")||o.includes("iva")?parseFloat(p):p}))};if(!r)return e.jsx("div",{className:"text-center mt-8",children:n("loading")});const a=(t,o="text")=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:t,children:n(t)}),c?o==="select"?e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:t,name:t,value:r[t],onChange:m,children:[e.jsx("option",{value:"product",children:n("product")}),e.jsx("option",{value:"material",children:n("material")})]}):e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:t,name:t,type:o,value:r[t],onChange:m,step:o==="number"?"0.01":void 0}):e.jsx("p",{className:"py-2 px-3 bg-gray-100 rounded",children:o==="number"?r[t].toFixed(2):r[t]})]});return e.jsxs("div",{className:"max-w-3xl mx-auto mt-8 p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:n("product_details")}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a("data_documento"),a("fornitore"),a("descrizione"),a("descrizione_interna"),a("prezzo_acquisto","number"),a("utile","number"),a("imponibile","number"),a("iva_10","number"),a("iva_22","number")]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[c?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300",type:"submit",children:n("save_changes")}),e.jsx("button",{className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300",type:"button",onClick:()=>d(!1),children:n("cancel")})]}):(s==null?void 0:s.role)==="admin"&&e.jsx("button",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300",type:"button",onClick:()=>d(!0),children:n("edit")}),e.jsx("button",{className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300",type:"button",onClick:()=>h("/products"),children:n("back_to_products")})]})]})]})};export{P as default};
