import{u as _,h as b,r as n,j as e}from"./index-Bju_Xr-6.js";import{a as k}from"./clientService-DWml5I6n.js";import{d as D}from"./reportService-C5rT5Bns.js";import{a as C}from"./usersService-CqL3O9jo.js";import{a as E}from"./worksiteService-Bsvx2crQ.js";import{T as c}from"./Tooltip-BnkEd6TM.js";import{f as R}from"./formatDate-CFXLpRQ8.js";const z=({reports:l,onReportDeleted:m})=>{const{t}=_(),p=b(),[T,h]=n.useState([]),[W,u]=n.useState([]),[S,f]=n.useState([]);n.useEffect(()=>{(async()=>{try{const[a,r,i]=await Promise.all([C(),k(),E()]);h(a.users),u(r.clients),f(i)}catch(a){console.error("Error fetching filter data:",a)}})()},[]);const g=async s=>{if(window.confirm(t("confirm_delete")))try{await D(s),m()}catch(a){console.error("Error deleting report:",a)}};return e.jsx("div",{children:l.length===0?e.jsx("p",{children:t("no_reports_found")}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("technician")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("short_description")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("activities")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("total_hours")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(s=>{var o,x;const a=typeof s.technician_id=="object"&&s.technician_id!==null?s.technician_id.name:t("not_assigned"),r=((o=s.activities)==null?void 0:o.reduce((y,j)=>{var d;const w=((d=j.tasks)==null?void 0:d.reduce((N,v)=>N+(v.work_hours||0),0))||0;return y+w},0))||0,i=((x=s.activities)==null?void 0:x.length)||0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.date?R(s.date,t):""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:e.jsx(c,{content:s.short_description||t("no_description"),children:e.jsx("span",{children:s.short_description||t("no_description")})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[i," ",t(i===1?"activity":"activities")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("span",{className:"font-medium",children:[r.toFixed(1)," ",t("hours")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="in_progress"?"bg-yellow-100 text-yellow-800":s.status==="planned"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:t(s.status)||t("not_specified")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{content:t("view_report"),children:e.jsx("button",{onClick:()=>p(`/reports/${s._id}`),className:"text-blue-500 hover:text-blue-700 font-medium",children:t("view")})}),e.jsx(c,{content:t("delete_report"),children:e.jsx("button",{onClick:()=>g(s._id),className:"text-red-500 hover:text-red-700 font-medium",children:t("delete")})})]})})]},s._id)})})]})})})};export{z as R};
